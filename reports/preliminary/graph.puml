@startuml
top to bottom direction

package "Model" #DDDDDD{
    class Game {
        - double timeWhite
        - double timeBlack
        - boolean isTimed
        - Board board
        - History history
        - Solver solver
        + boolean isOver()
        + String getStringHistory()
        + List<Move> getMovesHistory()
    }

    class History {
        - Tree<HistoryNode> tree
        - HistoryNode currentState
        + Move getPrevious()
        + List<Move> getNext()
        + addMove()
        + setCurrent(HistoryNode)
    }

    class HistoryNode {
        - Board state
        - Move previousMove
        - HistoryNode parent 
        - List<HistoryNode> children
        + addChildren(HistoryNode)
    }

    class Board {
        - Bitmap[12] board
        - boolean player
        - boolean enPassant
        + List<Move> getAvailableMoves()
        + boolean makeMove(Move move)
        + Board getCopy()
        + boolean isAttacked(int i, int j)
        + boolean isCheck()
        + boolean isCheckMate()
        + String getPieceAt(int i, int j)
    }

    class Bitboard {
        - long board
    }

    class Move {
        - String move
        + Piece getPiece()
        + getOriginalCol()
        + getOriginalRow()
        + getTargetCol()
        + getTargetRow()
        + Move getReverse()
        + String toString()
    }

    abstract Piece {
        - boolean isWhite
        + List<Move> getAvailableMoves(Board b)
    } 

    class Pawn {}
    class King {}
    class Queen {}
    class Rook {}
    class Bishop {}
    class Knight {}
}

package "View" #DDDDDD{
    interface Vue
    class CLIVue
    class GameVue
}

package "Controller" #DDDDDD{
    class GameController {
        - Vue vue
        - Game model
        + void handleEvent(GameEvent event)
    }
}

package "Events" #DDDDDD{
    class EventSource {
        - List<GameEventObserver> observers
        + void addObserver(GameEventObserver observer)
        + void removeObserver(GameEventObserver observer)
        + void notifyObservers(GameEvent event)
    }

    class GameEvent {
        - GameEventType eventType
        - Object data
        + GameEventType getEventType()
        + Object getEventData()
    }

    interface GameEventObserver {
        + void onGameEvent(GameEvent event)
    }

    enum GameEventType {
        PIECE_MOVED
        TIME_OUT
        GAME_WON
    }
}

package "Utils" #DDDDDD{
    package AI {
        class Solver {
            - Tree<AINode> aiHistory
            + Move getBestMove(Board board, String method, String heuristic, double time)
            - double evaluate(Board board, String heuristic)
            - Move ab_search(Board board, String heuristic, double time)
            - Move mtcs_search(Board board, String heuristic, double time)
        }

        class AINode {
            - HistoryNode hnode 
            - double value
        }
    }

    class TextGetter {
        - Locale locale
        - ResourceBundle messages
        + void init(Locale)
        + TextGetter getInstance()
        + String getText(String tag)
    }

    class Tree<T> {
        - T root
    }
}

Main --> GameController
Game --> Board
Game --> Move
Game --> EventSource
Game --> Solver
Board --> Move
Board --> Piece
Board --> Bitboard
GameController --> Vue
GameController --> Game
GameController --> GameEventObserver
EventSource --> GameEventObserver
GameEvent --> GameEventType
History --> Tree
History --> HistoryNode
Solver --> Tree
Solver --> AINode
Vue <|-- CLIVue
Vue <|-- GameVue

Piece <|-- Pawn
Piece <|-- King
Piece <|-- Queen
Piece <|-- Rook
Piece <|-- Bishop
Piece <|-- Knight

@enduml
